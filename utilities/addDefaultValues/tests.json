[
    {
        "description": "Given a schema with a default set for the 'name' property",
        "schema": {
            "$id": "https://example.com/1",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "default": "Kai"
                }
            }
        },
        "tests": [
            {
                "description": "When the schema is applied to an empty object, the name property should be set to default value",
                "instance": {},
                "expected": {
                    "name": "Kai"
                }
            },
            {
                "description": "When the schema is applied to an object where 'name' exists, then the property should not change",
                "instance": {
                    "name": "John"
                },
                "expected": {
                    "name": "John"
                }
            }
        ]
    },
    {
        "description": "Add defaults to nested properties",
        "schema": {
            "$id": "https://example.com/2",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "person": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": "string",
                            "default": "John"
                        },
                        "age": {
                            "type": "number",
                            "default": 25
                        }
                    }
                }
            }
        },
        "tests": [
            {
                "description": "When the schema is applied to an empty object, default values should be added to nested properties",
                "instance": {},
                "expected": {
                    "person": {
                        "name": "John",
                        "age": 25
                    }
                }
            }
        ]
    },
    {
        "description": "Add defaults to array",
        "schema": {
            "$id": "https://example.com/3",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "numbers": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    },
                    "default": [
                        40
                    ]
                }
            }
        },
        "tests": [
            {
                "description": "When the schema is applied to an object with an array, default values should be added to array items",
                "instance": {},
                "expected": {
                    "numbers": [
                        40
                    ]
                }
            }
        ]
    },
    {
        "description": "Add defaults to tuple",
        "schema": {
            "$id": "https://example.com/4",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "numbers": {
                    "type": "array",
                    "prefixItems": [
                        {
                            "type": "number",
                            "default": 39
                        },
                        {
                            "type": "string",
                            "default": "foo"
                        },
                        {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "Logan"
                                }
                            }
                        },
                        {
                            "type": "array",
                            "prefixItems": [
                                {
                                    "type": "string",
                                    "default": "Agnivesh"
                                },
                                {
                                    "type": "number",
                                    "default": 99999
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "tests": [
            {
                "description": "When the schema is applied to an object with a tuple, default values should be added to tuple items",
                "instance": {},
                "expected": {
                    "numbers": [
                        39,
                        "foo",
                        {
                            "name": "Logan"
                        },
                        [
                            "Agnivesh",
                            99999
                        ]
                    ]
                }
            }
        ]
    },
    {
        "description": "Handle invalid schema",
        "schema": {
            "$id": "https://example.com/5",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "invalid"
        },
        "tests": [
            {
                "description": "When the schema is invalid, an error should be thrown",
                "instance": {},
                "expected": "Invalid Json Schema"
            }
        ]
    },
    {
        "description": "Given a schema with a default set for the required properties",
        "schema": {
            "$id": "https://example.com/6",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "default": "Doe"
                },
                "age": {
                    "type": "number",
                    "default": 33
                }
            },
            "required": [
                "name"
            ]
        },
        "tests": [
            {
                "description": "When the schema is applied to an empty object, the properties which are present in the required list must set to default value",
                "instance": {},
                "expected": {
                    "name": "Doe",
                    "age": 33
                }
            },
            {
                "description": "When the schema is applied to an object which is already having some properties, the properties which are present in the required list should set to default value without changing the previous properties of the instance",
                "instance": {
                    "age": 90
                },
                "expected": {
                    "name": "Doe",
                    "age": 90
                }
            }
        ]
    },
    {
        "description": "Hierarchical ambiguous defaults",
        "schema": {
            "$id": "https://example.com/7",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "foo": {
                    "$ref": "#/$defs/foo",
                    "default": true
                }
            },
            "$defs": {
                "foo": {
                    "default": 42
                }
            }
        },
        "tests": [
            {
                "description": "given an empty object, the property is added",
                "instance": {},
                "expected": {
                    "foo": true
                }
            }
        ]
    },
    {
        "description": "Hierarchical ambiguous defaults always chooses the top default regardless of evaluation order",
        "schema": {
            "$id": "https://example.com/8",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "foo": {
                    "default": true,
                    "$ref": "#/$defs/foo"
                }
            },
            "$defs": {
                "foo": {
                    "default": 42
                }
            }
        },
        "tests": [
            {
                "description": "given an empty object, the property is added",
                "instance": {},
                "expected": {
                    "foo": true
                }
            }
        ]
    },
    {
        "description": "Hierarchical ambiguous defaults always chooses the top default regardless of evaluation order",
        "schema": {
            "$id": "https://example.com/8",
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "type": "object",
            "properties": {
                "foo": {
                    "$ref": "#/$defs/foo"
                }
            },
            "$defs": {
                "foo": {
                    "default": 42
                }
            }
        },
        "tests": [
            {
                "description": "given an empty object, the property is added",
                "instance": {},
                "expected": {
                    "foo": 42
                }
            }
        ]
    }
]